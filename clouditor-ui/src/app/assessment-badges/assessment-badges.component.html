<!--
  ~ Copyright (c) 2016-2019, Fraunhofer AISEC. All rights reserved.
  ~
  ~
  ~            $$\                           $$\ $$\   $$\
  ~            $$ |                          $$ |\__|  $$ |
  ~   $$$$$$$\ $$ | $$$$$$\  $$\   $$\  $$$$$$$ |$$\ $$$$$$\    $$$$$$\   $$$$$$\
  ~  $$  _____|$$ |$$  __$$\ $$ |  $$ |$$  __$$ |$$ |\_$$  _|  $$  __$$\ $$  __$$\
  ~  $$ /      $$ |$$ /  $$ |$$ |  $$ |$$ /  $$ |$$ |  $$ |    $$ /  $$ |$$ |  \__|
  ~  $$ |      $$ |$$ |  $$ |$$ |  $$ |$$ |  $$ |$$ |  $$ |$$\ $$ |  $$ |$$ |
  ~  \$$$$$$\  $$ |\$$$$$   |\$$$$$   |\$$$$$$  |$$ |  \$$$   |\$$$$$   |$$ |
  ~   \_______|\__| \______/  \______/  \_______|\__|   \____/  \______/ \__|
  ~
  ~ This file is part of Clouditor Community Edition.
  ~
  ~ Clouditor Community Edition is free software: you can redistribute it and/or modify
  ~ it under the terms of the GNU General Public License as published by
  ~ the Free Software Foundation, either version 3 of the License, or
  ~ (at your option) any later version.
  ~
  ~ Clouditor Community Edition is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~ GNU General Public License for more details.
  ~
  ~ You should have received a copy of the GNU General Public License
  ~ long with Clouditor Community Edition.  If not, see <https://www.gnu.org/licenses/>
  -->
<ng-container *ngIf="scan.lastResult">
  <span class="text-muted pr-3" ngbPopover="Executed every {{ scan.interval | amDuration:'seconds' }}"
    triggers="mouseenter:mouseleave" *ngIf="scan.enabled"><i class="fas fa-undo"></i>
    {{ scan.interval | amDuration:'seconds' }}</span>
  <span class="text-muted pr-3" *ngIf="!scan.enabled">Stopped</span>
  <span class="pointer pr-3 text-danger"
    ngbPopover="{{ nonCompliantAssets }}Â out of {{ compliantAssets + nonCompliantAssets }} resource(s) have rule violations"
    triggers="mouseenter:mouseleave" *ngIf="nonCompliantAssets > 0">
    <i class="fas fa-exclamation-circle"></i>&nbsp;<a [routerLink]="['/discovery', scan._id]"
      class="text-danger">{{ nonCompliantAssets }} resources with violations</a></span>
  <span class="pointer text-success pr-3 text-success"
    ngbPopover="{{ compliantAssets + nonCompliantAssets }} resources analyzed in total" triggers="mouseenter:mouseleave"
    *ngIf="nonCompliantAssets == 0"><i class="fas fa-check-circle">
    </i>&nbsp;<a [routerLink]="['/discovery', scan._id]" class="text-success">All resources are compliant</a></span>
  <span class="text-muted" ngbPopover="{{ scan.lastResult.timestamp | date:'medium' }}" triggers="mouseenter:mouseleave"
    *ngIf="!scan.isDiscovering">Updated {{ scan.lastResult.timestamp | amTimeAgo }}</span>
</ng-container>

<span class="pointer text-muted pr-3" ngbPopover="Executed every {{ scan.interval | amDuration:'seconds' }}"
  triggers="mouseenter:mouseleave" *ngIf="scan.isDiscovering"><i class="fas fa-circle-notch fa-spin"></i>
  Scanning...</span>