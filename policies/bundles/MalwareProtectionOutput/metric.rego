package clouditor.metrics.malware_protection_output

import future.keywords.every
import input.malwareProtection.applicationLogging as log
import input.related

default applicable = false

default compliant = false

applicable {
	log

	# we also need some kind of output to a logging service
	log.loggingService[_]
}

services[s] {
	related[_].id == log.loggingService[_]

	s := related[_]
}

compliant {
	# TODO(oxisto): It would be super cool to just depend on the transport_encryption_enabled metric for this
	# TODO(oxisto): Also it would be cool to depend on the logging_service_*_storage metrics
    every service in services {
		service.transportEncryption.enabled == true
	}
}
